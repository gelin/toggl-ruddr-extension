import{s as R,a as W,b as ne,c as O,d as q,l as ae,u as le,e as U,f as se,g as ie,h as v,i as oe,r as z,j as G,p as ue,I as C,k as J,m as fe,n as ce,o as H,E as ve,q as de,t as _e,v as ge,w as pe,x as he,y as me,z as ye,A as Q,B as be,C as Ee,D as ke,F as we,G as xe,H as Ae,J as Te,K as w,L as Ie,M as X,N as T,O as B,P as F,Q as Se,R as h,S as L,T as V,U as qe}from"./render.js";import{t as Ce,r as Le,g as Y,s as Me,a as Pe,b as Oe}from"./toggl.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();function Ne(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Re(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let We=!1,D=!1;function He(){D||(D=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var r;if(!e.defaultPrevented)for(const t of e.target.elements)(r=t.__on_r)==null||r.call(t)})},{capture:!0}))}function Be(e){var r=ne,t=O;R(null),W(null);try{return e()}finally{R(r),W(t)}}function Z(e,r,t,l=t){e.addEventListener(r,()=>Be(t));const n=e.__on_r;n?e.__on_r=()=>{n(),l(!0)}:e.__on_r=()=>l(!0),He()}function Fe(e){q===null&&Ne(),ae&&q.l!==null?Ve(q).m.push(e):le(()=>{const r=U(e);if(typeof r=="function")return r})}function Ve(e){var r=e.l;return r.u??(r.u={a:[],b:[],m:[]})}function De(e,r){return r}function Ke(e,r,t,l){for(var n=[],a=r.length,i=0;i<a;i++)de(r[i].e,n,!0);var d=a>0&&n.length===0&&t!==null;if(d){var g=t.parentNode;_e(g),g.append(t),l.clear(),E(e,r[0].prev,r[a-1].next)}ge(n,()=>{for(var _=0;_<a;_++){var s=r[_];d||(l.delete(s.k),E(e,s.prev,s.next)),pe(s.e,!d)}})}function Ue(e,r,t,l,n,a=null){var i=e,d={flags:r,items:new Map,first:null};{var g=e;i=g.appendChild(se())}var _=null,s=!1,p=oe(()=>{var o=t();return Q(o)?o:o==null?[]:J(o)});ie(()=>{var o=v(p),u=o.length;s&&u===0||(s=u===0,ze(o,d,i,n,r,l,t),a!==null&&(u===0?_?z(_):_=G(()=>a(i)):_!==null&&ue(_,()=>{_=null})),v(p))})}function ze(e,r,t,l,n,a,i){var d=e.length,g=r.items,_=r.first,s=_,p,o=null,u=[],f=[],m,k,c,y;for(y=0;y<d;y+=1){if(m=e[y],k=a(m,y),c=g.get(k),c===void 0){var ee=s?s.e.nodes_start:t;o=Je(ee,r,o,o===null?r.first:o.next,m,k,y,l,n,i),g.set(k,o),u=[],f=[],s=o.next;continue}if(Ge(c,m,y),(c.e.f&C)!==0&&z(c.e),c!==s){if(p!==void 0&&p.has(c)){if(u.length<f.length){var A=f[0],b;o=A.prev;var N=u[0],I=u[u.length-1];for(b=0;b<u.length;b+=1)K(u[b],A,t);for(b=0;b<f.length;b+=1)p.delete(f[b]);E(r,N.prev,I.next),E(r,o,N),E(r,I,A),s=A,o=I,y-=1,u=[],f=[]}else p.delete(c),K(c,s,t),E(r,c.prev,c.next),E(r,c,o===null?r.first:o.next),E(r,o,c),o=c;continue}for(u=[],f=[];s!==null&&s.k!==k;)(s.e.f&C)===0&&(p??(p=new Set)).add(s),f.push(s),s=s.next;if(s===null)continue;c=s}u.push(c),o=c,s=c.next}if(s!==null||p!==void 0){for(var S=p===void 0?[]:J(p);s!==null;)(s.e.f&C)===0&&S.push(s),s=s.next;var re=S.length;if(re>0){var te=d===0?t:null;Ke(r,S,te,g)}}O.first=r.first&&r.first.e,O.last=o&&o.e}function Ge(e,r,t,l){fe(e.v,r),e.i=t}function Je(e,r,t,l,n,a,i,d,g,_){var s=(g&me)!==0,p=(g&ye)===0,o=s?p?ce(n,!1,!1):H(n):n,u=(g&ve)===0?i:H(i),f={i:u,v:o,k:a,a:null,e:null,prev:t,next:l};try{return f.e=G(()=>d(e,o,u,_),We),f.e.prev=t&&t.e,f.e.next=l&&l.e,t===null?r.first=f:(t.next=f,t.e.next=f.e),l!==null&&(l.prev=f,l.e.prev=f.e),f}finally{}}function K(e,r,t){for(var l=e.next?e.next.e.nodes_start:t,n=r?r.e.nodes_start:t,a=e.e.nodes_start;a!==l;){var i=he(a);n.before(a),a=i}}function E(e,r,t){r===null?e.first=t:(r.next=t,r.e.next=t&&t.e),t!==null&&(t.prev=r,t.e.prev=r&&r.e)}function $(e,r,t){if(e.multiple){if(r==null)return;if(!Q(r))return Re();for(var l of e.options)l.selected=r.includes(x(l));return}for(l of e.options){var n=x(l);if(ke(n,r)){l.selected=!0;return}}(!t||r!==void 0)&&(e.selectedIndex=-1)}function Qe(e){var r=new MutationObserver(()=>{$(e,e.__value)});r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ee(()=>{r.disconnect()})}function Xe(e,r,t=r){var l=!0;Z(e,"change",n=>{var a=n?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(a),x);else{var d=e.querySelector(a)??e.querySelector("option:not([disabled])");i=d&&x(d)}t(i)}),be(()=>{var n=r();if($(e,n,l),l&&n===void 0){var a=e.querySelector(":checked");a!==null&&(n=x(a),t(n))}e.__value=n,l=!1}),Qe(e)}function x(e){return"__value"in e?e.__value:e.value}function Ye(e,r){r?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function Ze(e,r,t=r){var l=we();Z(e,"input",n=>{var a=n?e.defaultValue:e.value;if(a=M(e)?P(a):a,t(a),l&&a!==(a=r())){var i=e.selectionStart,d=e.selectionEnd;e.value=a??"",d!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(d,e.value.length))}}),U(r)==null&&e.value&&t(M(e)?P(e.value):e.value),xe(()=>{var n=r();M(e)&&n===P(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function M(e){var r=e.type;return r==="number"||r==="range"}function P(e){return e===""?null:+e}async function $e(e,r,t,l,n){h(r,"Testing...");try{h(r,await Ce(v(t)),!0),h(l,await Le(v(t)),!0),h(n,await Y(),!0)}catch(a){console.error("Error testing token:",a),h(r,a.message,!0)}}async function je(e,r,t,l){try{await Me({token:v(r),workspace:v(t)}),h(l,"Settings saved successfully")}catch(n){console.error("Error saving settings:",n),h(l,"Error saving settings: "+n.message)}}var er=X("<option> </option>"),rr=X('<form><label for="toggl_token" class="svelte-1tqcnsd">Toggl Track API token</label> <input id="toggl_token" type="text" class="svelte-1tqcnsd"/> <label for="toggl_workspace" class="svelte-1tqcnsd">Toggl Workspace</label> <select id="toggl_workspace" class="svelte-1tqcnsd"></select> <p class="message"> </p> <button type="button">Refresh & Save</button></form>');function tr(e,r){Te(r,!0);let t=w(""),l=w(Ie([])),n=w(void 0),a=w(""),i=w(!0);Fe(async()=>{try{h(t,await Pe()||"",!0),h(l,await Oe(),!0),h(n,await Y(),!0),h(i,!1)}catch(u){console.error("Error loading settings:",u),h(a,"Error loading settings"),h(i,!1)}});var d=rr(),g=T(L(d),2);g.__change=[$e,a,t,l,n];var _=T(g,4);Ue(_,21,()=>v(l),De,(u,f)=>{var m=er(),k=L(m),c={};B(()=>{Ye(m,v(f).selected),V(k,v(f).name),c!==(c=v(f).id)&&(m.value=(m.__value=v(f).id)??"")}),F(u,m)});var s=T(_,2),p=L(s),o=T(s,2);o.__click=[je,t,n,a],B(()=>{g.disabled=v(i),_.disabled=v(i)||v(l).length===0,V(p,v(a)),o.disabled=v(i)||!v(t)||!v(n)}),Ze(g,()=>v(t),u=>h(t,u)),Xe(_,()=>v(n),u=>h(n,u)),F(e,d),Se()}Ae(["change","click"]);const j=document.getElementById("popup");if(!j)throw new Error("Could not find popup container");qe(tr,{target:j});
