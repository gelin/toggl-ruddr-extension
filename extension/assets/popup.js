import{s as R,a as W,b as ne,c as O,d as q,l as ae,u as le,e as K,f as se,g as ie,h as v,i as oe,r as U,j as z,p as ue,I as C,k as J,m as fe,n as ce,o as G,E as ve,q as de,t as _e,v as ge,w as pe,x as he,y as me,z as ye,A as Q,B as be,C as Ee,D as ke,F as we,G as xe,H as Te,J as Ae,K as w,L as Se,M as X,N as A,O as H,P as B,Q as Ie,R as h,S as L,T as F,U as qe}from"./render.js";import{t as Ce,a as Le,b as Y,c as Me,d as Pe,e as Oe}from"./toggl.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();function Ne(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Re(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let We=!1,V=!1;function Ge(){V||(V=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const r of e.target.elements)(t=r.__on_r)==null||t.call(r)})},{capture:!0}))}function He(e){var t=ne,r=O;R(null),W(null);try{return e()}finally{R(t),W(r)}}function Z(e,t,r,l=r){e.addEventListener(t,()=>He(r));const n=e.__on_r;n?e.__on_r=()=>{n(),l(!0)}:e.__on_r=()=>l(!0),Ge()}function Be(e){q===null&&Ne(),ae&&q.l!==null?Fe(q).m.push(e):le(()=>{const t=K(e);if(typeof t=="function")return t})}function Fe(e){var t=e.l;return t.u??(t.u={a:[],b:[],m:[]})}function Ve(e,t){return t}function De(e,t,r,l){for(var n=[],a=t.length,i=0;i<a;i++)de(t[i].e,n,!0);var d=a>0&&n.length===0&&r!==null;if(d){var g=r.parentNode;_e(g),g.append(r),l.clear(),E(e,t[0].prev,t[a-1].next)}ge(n,()=>{for(var _=0;_<a;_++){var s=t[_];d||(l.delete(s.k),E(e,s.prev,s.next)),pe(s.e,!d)}})}function Ke(e,t,r,l,n,a=null){var i=e,d={flags:t,items:new Map,first:null};{var g=e;i=g.appendChild(se())}var _=null,s=!1,p=oe(()=>{var o=r();return Q(o)?o:o==null?[]:J(o)});ie(()=>{var o=v(p),u=o.length;s&&u===0||(s=u===0,Ue(o,d,i,n,t,l,r),a!==null&&(u===0?_?U(_):_=z(()=>a(i)):_!==null&&ue(_,()=>{_=null})),v(p))})}function Ue(e,t,r,l,n,a,i){var d=e.length,g=t.items,_=t.first,s=_,p,o=null,u=[],f=[],m,k,c,y;for(y=0;y<d;y+=1){if(m=e[y],k=a(m,y),c=g.get(k),c===void 0){var ee=s?s.e.nodes_start:r;o=Je(ee,t,o,o===null?t.first:o.next,m,k,y,l,n,i),g.set(k,o),u=[],f=[],s=o.next;continue}if(ze(c,m,y),(c.e.f&C)!==0&&U(c.e),c!==s){if(p!==void 0&&p.has(c)){if(u.length<f.length){var T=f[0],b;o=T.prev;var N=u[0],S=u[u.length-1];for(b=0;b<u.length;b+=1)D(u[b],T,r);for(b=0;b<f.length;b+=1)p.delete(f[b]);E(t,N.prev,S.next),E(t,o,N),E(t,S,T),s=T,o=S,y-=1,u=[],f=[]}else p.delete(c),D(c,s,r),E(t,c.prev,c.next),E(t,c,o===null?t.first:o.next),E(t,o,c),o=c;continue}for(u=[],f=[];s!==null&&s.k!==k;)(s.e.f&C)===0&&(p??(p=new Set)).add(s),f.push(s),s=s.next;if(s===null)continue;c=s}u.push(c),o=c,s=c.next}if(s!==null||p!==void 0){for(var I=p===void 0?[]:J(p);s!==null;)(s.e.f&C)===0&&I.push(s),s=s.next;var te=I.length;if(te>0){var re=d===0?r:null;De(t,I,re,g)}}O.first=t.first&&t.first.e,O.last=o&&o.e}function ze(e,t,r,l){fe(e.v,t),e.i=r}function Je(e,t,r,l,n,a,i,d,g,_){var s=(g&me)!==0,p=(g&ye)===0,o=s?p?ce(n,!1,!1):G(n):n,u=(g&ve)===0?i:G(i),f={i:u,v:o,k:a,a:null,e:null,prev:r,next:l};try{return f.e=z(()=>d(e,o,u,_),We),f.e.prev=r&&r.e,f.e.next=l&&l.e,r===null?t.first=f:(r.next=f,r.e.next=f.e),l!==null&&(l.prev=f,l.e.prev=f.e),f}finally{}}function D(e,t,r){for(var l=e.next?e.next.e.nodes_start:r,n=t?t.e.nodes_start:r,a=e.e.nodes_start;a!==l;){var i=he(a);n.before(a),a=i}}function E(e,t,r){t===null?e.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}function $(e,t,r){if(e.multiple){if(t==null)return;if(!Q(t))return Re();for(var l of e.options)l.selected=t.includes(x(l));return}for(l of e.options){var n=x(l);if(ke(n,t)){l.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function Qe(e){var t=new MutationObserver(()=>{$(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ee(()=>{t.disconnect()})}function Xe(e,t,r=t){var l=!0;Z(e,"change",n=>{var a=n?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(a),x);else{var d=e.querySelector(a)??e.querySelector("option:not([disabled])");i=d&&x(d)}r(i)}),be(()=>{var n=t();if($(e,n,l),l&&n===void 0){var a=e.querySelector(":checked");a!==null&&(n=x(a),r(n))}e.__value=n,l=!1}),Qe(e)}function x(e){return"__value"in e?e.__value:e.value}function Ye(e,t){t?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function Ze(e,t,r=t){var l=we();Z(e,"input",n=>{var a=n?e.defaultValue:e.value;if(a=M(e)?P(a):a,r(a),l&&a!==(a=t())){var i=e.selectionStart,d=e.selectionEnd;e.value=a??"",d!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(d,e.value.length))}}),K(t)==null&&e.value&&r(M(e)?P(e.value):e.value),xe(()=>{var n=t();M(e)&&n===P(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function M(e){var t=e.type;return t==="number"||t==="range"}function P(e){return e===""?null:+e}async function $e(e,t,r,l,n){h(t,"Testing...");try{h(t,await Ce(v(r)),!0),h(l,await Le(v(r)),!0),h(n,await Y(),!0)}catch(a){console.error("Error testing token:",a),h(t,a.message,!0)}}async function je(e,t,r,l){try{await Me({token:v(t),workspace:v(r)}),h(l,"Settings saved successfully")}catch(n){console.error("Error saving settings:",n),h(l,"Error saving settings: "+n.message)}}var et=X("<option> </option>"),tt=X('<form><label for="toggl_token" class="svelte-1tqcnsd">Toggl Track API token</label> <input id="toggl_token" type="text" class="svelte-1tqcnsd"/> <label for="toggl_workspace" class="svelte-1tqcnsd">Toggl Workspace</label> <select id="toggl_workspace" class="svelte-1tqcnsd"></select> <p class="message"> </p> <button type="button">Refresh & Save</button></form>');function rt(e,t){Ae(t,!0);let r=w(""),l=w(Se([])),n=w(void 0),a=w(""),i=w(!0);Be(async()=>{try{h(r,await Pe()||"",!0),h(l,await Oe(),!0),h(n,await Y(),!0),h(i,!1)}catch(u){console.error("Error loading settings:",u),h(a,"Error loading settings"),h(i,!1)}});var d=tt(),g=A(L(d),2);g.__change=[$e,a,r,l,n];var _=A(g,4);Ke(_,21,()=>v(l),Ve,(u,f)=>{var m=et(),k=L(m),c={};H(()=>{Ye(m,v(f).selected),F(k,v(f).name),c!==(c=v(f).id)&&(m.value=(m.__value=v(f).id)??"")}),B(u,m)});var s=A(_,2),p=L(s),o=A(s,2);o.__click=[je,r,n,a],H(()=>{g.disabled=v(i),_.disabled=v(i)||v(l).length===0,F(p,v(a)),o.disabled=v(i)||!v(r)||!v(n)}),Ze(g,()=>v(r),u=>h(r,u)),Xe(_,()=>v(n),u=>h(n,u)),B(e,d),Ie()}Te(["change","click"]);const j=document.getElementById("popup");if(!j)throw new Error("Could not find popup container");qe(rt,{target:j});
